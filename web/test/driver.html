<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Driver Panel</title>
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script>
        $(document).ready(function () {
            var socket;

            $("#connectBtn").click(function () {
                var token = $("#token").val();
                // bla
                socket = new WebSocket("ws://" + window.location.host + "/wsapp/2/" + token);

                socket.onopen = function (arg) {
                    console.log("success", "connected");
                };

                socket.onmessage = function (arg) {
                    console.log("success", arg.data);

                    var $notifications = $("#notifications");

                    $notifications.append("<li>" + arg.data + "</li>");
                };

                socket.onclose = function (arg) {
                    console.log("success", "disconnected");
                };

                socket.error = function (arg) {
                    console.error(arg.data);
                }
            });

            $("#disconnectBtn").click(function () {
                socket.close();
            });

            $("#sendBtn").click(function () {
                var token = $("#userToken").val();
                var msg = $("#message").val();

                $.get("/send", {"action": "sendToUser", "token": token, "message": msg})
                        .done(function () {
                            console.log("success", "Message Sent");
                        })
                        .fail(function (data) {
                            console.error(data);
                        });
            });
        });
    </script>
</head>
<body>

<div>
    <label for="token">Token</label>
    <input type="text" id="token"/>
    <button id="connectBtn">Connect</button>
    <button id="disconnectBtn">Disconnect</button>
</div>

<br/>

<div>
    <label for="userToken">Driver Token:</label>
    <input type="text" id="userToken"/>
    <label for="message">Message:</label>
    <input type="text" id="message"/>
    <button id="sendBtn">Send Message</button>
</div>

<br/>

<div>
    <ul id="notifications">

    </ul>
</div>

</body>
</html>